<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translation Speaker - TalkSync</title>
    <link rel="stylesheet" href="/dash/style.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <h1 class="sidebar-logo">TalkSync</h1>
            <p class="sidebar-subtitle">Speaker</p>
        </div>
        <nav class="sidebar-nav">
            <a href="/dash" class="nav-item">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <rect x="3" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    <rect x="3" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    <rect x="11" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    <rect x="11" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                </svg>
                <span>Обзор</span>
            </a>
            <a href="/rtmp-relay" class="nav-item">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M10 4V16M10 16L6 12M10 16L14 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>RTMP Relay</span>
            </a>
            <a href="/transcription-normalizer" class="nav-item">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M4 6H16M4 10H16M4 14H10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span>Normalizer</span>
            </a>
            <a href="/transcription-translator" class="nav-item">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M3 5H11M9 3V5M5.5 5C5.5 9 7 13 10 15M6 8L8 10M3 15L5 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M13 9L17 15M17 9L13 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Translator</span>
            </a>
            <a href="/translation-speaker" class="nav-item active">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M6 7L11 4V16L6 13H4C3.44772 13 3 12.5523 3 12V8C3 7.44772 3.44772 7 4 7H6Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                    <path d="M14 7C15.1046 8.10457 15.1046 9.89543 14 11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    <path d="M16 5C17.6569 6.65685 17.6569 11.3431 16 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span>Speaker</span>
            </a>
            <a href="/whisperx-relay" class="nav-item">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M10 2C10 2 8 4 8 7C8 10 10 12 10 12M10 2C10 2 12 4 12 7C12 10 10 12 10 12M10 2V12M10 12V18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="10" cy="18" r="1" fill="currentColor"/>
                </svg>
                <span>WhisperX Relay</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <a href="/" class="nav-item">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M3 10H17M17 10L13 6M17 10L13 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Слушать перевод</span>
            </a>
        </div>
    </aside>

    <main class="main-content">
        <header class="page-header">
            <div class="header-left">
                <h1 class="page-title">Translation Speaker</h1>
                <p class="page-description">Автоматическое озвучивание переводов через OpenAI TTS</p>
                <div style="margin-top: 6px;">
                    <span class="status-indicator" id="wsStatus"></span>
                    <span id="wsStatusText">Подключение...</span>
                </div>
            </div>
            <div class="header-right">
                <button class="btn btn-ghost btn-sm" onclick="loadSpeakers()">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M14 8C14 11.3137 11.3137 14 8 14C4.68629 14 2 11.3137 2 8C2 4.68629 4.68629 2 8 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M14 4L8 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    Обновить
                </button>
            </div>
        </header>

        <section class="card">
            <div class="card-header">
                <h2 class="card-title">Создать новый Speaker</h2>
            </div>
            <div class="card-content">
                <div class="form-group">
                    <label for="translatorSelect">Translator (источник переводов):</label>
                    <select id="translatorSelect">
                        <option value="">Загрузка...</option>
                    </select>
                </div>

                <div class="settings-grid">
                    <div class="form-group">
                        <label for="voiceSelect">Голос:</label>
                        <select id="voiceSelect">
                            <option value="alloy">Alloy</option>
                            <option value="echo">Echo</option>
                            <option value="fable">Fable</option>
                            <option value="onyx">Onyx</option>
                            <option value="nova">Nova</option>
                            <option value="shimmer">Shimmer</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="modelSelect">Модель:</label>
                        <select id="modelSelect">
                            <option value="tts-1">TTS-1 (быстрая)</option>
                            <option value="tts-1-hd">TTS-1-HD (качественная)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="speedInput">Скорость (0.25 - 4.0):</label>
                        <input type="number" id="speedInput" min="0.25" max="4.0" step="0.25" value="2.0">
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="autoSpeakCheck" checked>
                            Автоматическое озвучивание
                        </label>
                    </div>
                </div>

                <div class="form-actions">
                    <button class="btn btn-primary" id="createSpeakerBtn" onclick="createSpeaker()">Создать Speaker</button>
                </div>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                <h2 class="card-title">Активные Speakers</h2>
            </div>
            <div class="card-content">
                <div id="speakersList">
                    <div class="empty-state-small">
                        <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                            <circle cx="24" cy="24" r="18" stroke="currentColor" stroke-width="2" opacity="0.3"/>
                            <path d="M24 16V24L30 28" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.3"/>
                        </svg>
                        <p>Нет активных speakers. Создайте новый speaker выше.</p>
                    </div>
                </div>
            </div>
        </section>

        <div class="stats-grid" id="statsContainer" style="display: none;">
            <div class="stat-card">
                <div class="stat-header"><span class="stat-label">Озвучено</span></div>
                <div class="stat-value" id="statSpeechCompleted">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-header"><span class="stat-label">Ошибок</span></div>
                <div class="stat-value" id="statSpeechFailed">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-header"><span class="stat-label">Символов</span></div>
                <div class="stat-value" id="statTotalCharacters">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-header"><span class="stat-label">В очереди</span></div>
                <div class="stat-value" id="statQueueLength">0</div>
            </div>
        </div>

        <section class="card" id="resultsSection" style="display: none;">
            <div class="card-header">
                <h2 class="card-title">Результаты озвучивания</h2>
            </div>
            <div class="card-content">
                <div id="resultsList"></div>
            </div>
        </section>

        <section class="card" id="logsSection" style="display: none;">
            <div class="card-header">
                <h2 class="card-title">Логи</h2>
            </div>
            <div class="card-content">
                <div id="logsList"></div>
            </div>
        </section>
    </main>

    <div id="toastContainer" class="toast-container"></div>
    <script src="script.js"></script>
</body>
</html>
